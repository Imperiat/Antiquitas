roman_1_republic = {
	icon = athens_2
	header = mission_image_rome
	
	repeatable = no

    chance = {
		factor = 3
	}
	
	potential = { 
		NOT = { has_variable = roman_mission_00_republic }
		tag = ROM
		OR = {
			government = despotic_monarchy
			government = stratocratic_monarchy
			government = theocratic_monarchy
			government = aristocratic_monarchy
		}
		has_civil_war = no
	}
	
	abort = {
		ai_mission_back_out_trigger = yes
	}

    on_start = {
    	start_mission_ai_effect = yes
    	save_scope_as = me_rome_scope
    }

    on_abort = {
    	custom_tooltip = general_mission_cooldown_tt
		set_variable = {
			name = roman_mission_00_republic
			days = 7300
		}
		c:ROM = {
			if = {
				limit = { has_variable = building_temple_of_jupiter }
				remove_variable = building_temple_of_jupiter
			}
			if = {
				limit = { has_variable = temple_of_jupiter_planned }
				remove_variable = temple_of_jupiter_planned
			}
		}
    }

    on_completion = {
    	complete_mission_effect = yes
		c:ROM = {
			if = {
				limit = { has_variable = building_temple_of_jupiter }
				remove_variable = building_temple_of_jupiter
			}
			if = {
				limit = { has_variable = temple_of_jupiter_planned }
				remove_variable = temple_of_jupiter_planned
			}
		}
    }

	roman_0_temple_plans = {
		icon = task_political

		duration = 90

		allow = {
            treasury >= 20
		}

		on_start = {
			add_treasury = -20
			custom_tooltip = roman_0_temple_plans_tooltip_start
			trigger_event = me_roman_0_republic.8
		}

		on_completion = {
			custom_tooltip = roman_0_temple_plans_tooltip_complete
			trigger_event = me_roman_0_republic.9
		}
	}

	roman_0_temple_of_jupiter_money = {
		icon = task_economical

		prevented_by = { roman_0_temple_of_jupiter_slavery }

		bypass = {
			has_completed_mission_task = roman_0_temple_of_jupiter_slavery
    	}

		requires = { roman_0_temple_plans }

		duration = 1095

		allow = {
            treasury >= 600
			owns_or_subject_owns = 1
			c:ROM={
				has_variable = temple_of_jupiter_planned
			}
        }

		highlight = {
			scope:province = {
				OR = {
					province_id = 1
				}
			}
		}

		on_start = {
			add_treasury = -600
			p:1 = {
				begin_great_work_construction = {
					great_work = "temple_of_jupiter"
					locator = primary_great_work
					is_ancient = yes						
				}
			}
			c:ROM = {
				set_variable = {
					name = building_temple_of_jupiter
				}
				remove_variable = temple_of_jupiter_planned
			}
		}

		on_completion = {
			p:1 = {
				finish_great_work_construction = {
					great_work = "temple_of_jupiter"
					locator = primary_great_work
				}
			}
			c:ROM = {
				remove_variable = building_temple_of_jupiter
			}
		}
	}

	roman_0_temple_of_jupiter_slavery = {
		icon = task_conquest

		prevented_by = { roman_0_temple_of_jupiter_money }

		bypass = {
			has_completed_mission_task = roman_0_temple_of_jupiter_money
    	}

		requires = { roman_0_temple_plans }

		duration = 1095

		allow = {
			owns_or_subject_owns = 1
			p:1 = {
				any_pops_in_province = {
					count >= 6
					pop_type = slaves
				}
			}
			c:ROM={
				has_variable = temple_of_jupiter_planned
			}
        }

		highlight = {
			scope:province = {
				OR = {
					province_id = 1
				}
			}
		}

		on_start = {
			p:1 = {
				while = {
					count = 6
					random_pops_in_province = {
						limit = {
							pop_type = slaves
						}
						kill_pop = yes
					}
				}
			}
			p:1 = {
				begin_great_work_construction = {
					great_work = "temple_of_jupiter"
					locator = primary_great_work
					is_ancient = yes						
				}
			}
			c:ROM = {
				set_variable = {
					name = building_temple_of_jupiter
				}
				remove_variable = temple_of_jupiter_planned
			}
		}

		on_completion = {
			p:1 = {
				finish_great_work_construction = {
					great_work = "temple_of_jupiter"
					locator = primary_great_work
				}
			}
			c:ROM = {
				remove_variable = building_temple_of_jupiter
			}
		}
	}

	roman_0_independent_preisthood = {
		icon = task_economical

		requires = { roman_0_temple_of_jupiter_money roman_0_temple_of_jupiter_slavery }

		allow = {
			political_influence >= 15
			stability < 60
		}

		on_completion = {
			add_stability = -10
			custom_tooltip = roman_0_republic_independent_priesthood_tooltip
			trigger_event = me_roman_0_republic.7
		}
	}

	roman_0_allies = {
		icon = task_political

		requires = {roman_0_expanding_wine roman_0_capuan_way}

		allow = {
			political_influence >= 80
		}

		on_completion = {
			add_political_influence = -80
			custom_tooltip = roman_0_republic_allies_tooltip
			trigger_event = me_roman_0_republic.5
		}
	}

	roman_0_capua = {
		icon = task_expansion

		allow = {
			owns_or_subject_owns = 5
			owns_or_subject_owns = 6
		}
		
		highlight = {
			scope:province = {
				OR = {
					province_id = 5
					province_id = 6
				}
			}
		}

		on_completion = {
			p:6= {
				add_province_modifier = {
					name = trade_city_mission_modifier
					duration = 3650
				}
			}
		}
	}

	roman_0_ostia = {
		icon = task_economical

		allow = {
			owns = 15
			p:15 = {
				num_of_port_building >= 2
				num_of_commerce_building >= 2
			}
		}

		duration = 45
		
		highlight = {
			scope:province = {
				OR = {
					province_id = 15
				}
			}
		}

		on_completion = {
			p:1 = {
				if = {
					limit = {
						NOT = { has_road_towards = p:15 }
					}
					add_road_towards = p:15
				}
			}
			add_country_modifier = {
				name = roman_mission_00_republic_ostia_modifier
				duration = 3650
			}
		}
	}

	roman_0_expanding_wine = {
		icon = task_economical

		requires = { roman_0_ostia }

		allow = {
			owns = 2
			owns = 16

			p:1.state = {
				trade_good_surplus = { 
					target = wine 
					value >= 3 
				}
			}
			political_influence >= 20
		}

		highlight = {
			scope:province = {
				OR = {
					province_id = 2
					province_id = 16
				}
			}
		}

		on_start = {
			add_political_influence = -20
			trigger_event = me_roman_0_republic.3
		}

		duration = 365

		on_completion = {
			custom_tooltip = roman_0_republic_expanding_wine_tooltip
			trigger_event = me_roman_0_republic.4
		}
	}
	
	roman_0_capuan_way = {
		icon = task_economical

		requires = { roman_0_capua }

		allow = {
            treasury >= 50
			owns_or_subject_owns = 1
			owns_or_subject_owns = 2
			owns_or_subject_owns = 4
			owns_or_subject_owns = 5
			owns_or_subject_owns = 6
        }

		duration = 365

		highlight = {
			scope:province = {
				OR = {
					province_id = 1
					province_id = 2
					province_id = 4
					province_id = 5
					province_id = 6
				}
			}
		}

		on_completion = {
			custom_tooltip = roman_0_republic_capuan_way_tooltip
			trigger_event = me_roman_0_republic.6
		}
	}

	roman_0_neapolis = {
		icon = task_conquest

		requires = { roman_0_capua }

		allow = {
			owns_or_subject_owns = 7
		}

		highlight = {
			scope:province = {
				OR = {
					province_id = 7
				}
			}
		}

		on_completion = {
			p:7 = {
				add_province_modifier = {
					name = trade_city_mission_modifier
					duration = 3650
				}
			}
		}
	}

	roman_0_abolish_the_monarchy_peacefully = {
		final = yes
		icon = task_political

		potential = {
			is_ai = no
		}

		prevented_by = { roman_0_abolish_the_monarchy_aggressively }

		bypass = {
			has_completed_mission_task = roman_0_abolish_the_monarchy_aggressively
    	}

		requires = { roman_0_independent_preisthood roman_0_allies }

		on_completion = {
			custom_tooltip = roman_0_republic_abolish_the_monarchy_peacefully_tooltip
			trigger_event = me_roman_0_republic.1
		}
	}

	roman_0_abolish_the_monarchy_aggressively = {
		final = yes
		icon = task_political

		potential = {
			is_ai = no
		}

		prevented_by = { roman_0_abolish_the_monarchy_peacefully }

		bypass = {
			has_completed_mission_task = roman_0_abolish_the_monarchy_peacefully
    	}

		allow = {
			exists = current_ruler
			current_ruler = {
				popularity < 10
			}
			tyranny > 50
			has_war_exhaustion >= 20
		}

		on_completion = {
			custom_tooltip = roman_0_republic_abolish_the_monarchy_aggressively_tooltip
			trigger_event = me_roman_0_republic.2
		}
	}
}